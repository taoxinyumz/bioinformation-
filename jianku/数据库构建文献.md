## Prophage Hunter: an integrative hunting tool for active prophages
+  活性质粒也可以被用于探究噬菌体的生理和生化特性。质粒可以携带一些关键的基因元素，如抗性基因、代谢途径相关基因等，这些基因元素可以对噬菌体的生理和生化特性产生影响。
+  当细菌受到压力或适宜条件时，预噬菌体可以通过诱导进入激活状态并释放成熟的噬菌体颗粒（讲一下预噬菌体的概念）
+  利用细菌NGS数据预测噬菌体的存在。  所用的算法：MARVEL。   能做到的事情：序列组成的统计信息、序列相似性、结构和功能信息。    具体分工：（1）预测噬菌体序列（MARVEL） （2）识别原核病毒序列（VirFinder） （3）识别和注释预噬菌体序列（PHASTER）  （4）识别噬菌体的来源（MetaPhinder）
+  弊端：忽略了噬菌体经历的常见突变事件，只能识别基因/蛋白质与其数据库中记录相接近的噬菌体。
+  新型的综合性预测工具：Prophage Hunter    采用序列相似性搜索和基于预测基因特征的机器学习分类来评估噬菌体活性的概率，以便于预测细菌基因组中的噬菌体区域，Prophage Hunter不仅提高了预测的准确性，而且还提供了跳过相似性搜索以寻找新型噬菌体的选项。
+  亮点：不仅提高了预测的准确性，而且还提供了跳过相似性搜索以寻找新型噬菌体的选项。
+  一个被干扰的噬菌体基因组可能表现出基因特征的变化，包括转录方向、蛋白质长度、氨基酸组成（氨基酸出现的频率）、Watson-Crick比率（两条链之比）和转录链切换等
+  过程：下载基因组序列，作为Prophage Hunter机器学习方法的正训练集。其余的2509个噬菌体基因组序列被视为正验证集。将所有可能的噬菌体序列从宿主中删除后，剩余的序列被视为负数据集。
+  亮点：Prophage Hunter机器学习方法的特色
+  21,979个干净的片段，其长度等于它们包含的噬菌体，用作负训练集，并且使用5,495个干净片段作为负验证集。为了避免各种扰动事件的干扰，在计算机模拟中被随机扰动，扰动方式包括插入（从细菌宿主中插入的序列）、删除（从噬菌体中删除的序列）或倒位（在噬菌体内倒位的序列），扰动大小为噬菌体区域大小的一半，生成了2154个半合成数据集。
+  亮点：合成数据集的使用可以帮助研究人员在控制变量的情况下测试算法或模型的性能。这对于在真实世界的数据集上训练算法可能过于困难或成本高昂的情况尤其有用。在本文中，使用合成数据集可以测试算法在预测具有不同类型和程度的基因组扰动的噬菌体区域中的表现。
+  
+  
+  
## 工作流程
模糊匹配：
（1）创建噬菌体零件库，用了2101个注释的噬菌体基因组，提取CDS后用cd-hit去重复；（Cd-hit是一种基于序列相似度的聚类算法，用于处理大规模的蛋白质或核酸序列数据，以去除高度相似或重复的序列，从而简化数据分析。）
（2）随后基于功能对这些零件进行分类，使用InterProScan将这些蛋白质序列与Pfam数据库进行搜索，以获取它们的结构域，搜索参数为“-dp -f tsv -goterms -appl Pfam -iprlookup” 
（3）四个类别（ASB、HYP、INF和UNS）与活性噬菌体的存在高度相关。使用BLASTX将它们与ASB、HYP、INF和UNS库的蛋白质序列进行搜索，BLASTX是一种比对核酸序列与蛋白质序列的算法，参数“-seg no”表示不对序列进行低复杂度段的过滤。于是筛选出具有潜在噬菌体零件的序列  
（4）然后，使用InterProScan对筛选后的序列进行Pfam数据库搜索，参数为“-dp -f tsv -goterms -appl Pfam -iprlookup”，只保留包含ASB、HYP、INF和UNS库的蛋白质序列的结构域的序列。对于“跳过相似性匹配”的选项，上述程序可充当相似性搜索的替代方法。     
此处两个比对的意义：1.使用BLASTX将组装后的细菌基因组序列与噬菌体零件库的蛋白质序列进行搜索，可以找到具有高度相似性的噬菌体零件序列。     2.使用InterProScan将筛选后的序列与Pfam数据库进行搜索，以确定这些序列中是否存在特定的蛋白质结构域，这可以帮助确定噬菌体零件的功能。


边界定位：
（1）如果间隔小于5kb，则使用包含上述四类基因的细菌基因组DNA序列形成初始聚类。 （间隔小于5 kb”是指在基因组DNA序列中，四类基因之间的距离小于或等于5 kb，保证这些基因在同一个预测的噬菌体区域内）
（2）删除不包含INF、ASB、PAC或整合酶的聚类。提取每个聚类的上下游20 kb序列，使用BLASTN检查可能的att位点，参数为“-task blastn-short -evalue 1000”。（att位点可以作为两个噬菌体的边界，在参数中evalue 1000表示匹配到期望得分的次数，越低的E-value表示更可靠）
（3）对于所有聚类，我们使用整合酶作为锚点，因为它们位于真正的att位点的下游。仅保留长度≥12 bp的可能的att位点，并将具有最佳序列比对（最高的比特分数）的attL-attR对视为噬菌体区域的边界。 （保留长度≥12 bp的可能的att位点是因为att位点通常由一对直接重复序列组成，这对序列的长度通常为10-20 bp，这样可以确保att位点对于整合点的确定是可靠的。）

活性评分：
采用基于逻辑回归的方法来区分宿主和噬菌体序列：
（1）具体来说，我们设计了一个集成装袋方法，该方法平均了一组带有LASSO正则化的线性回归模型，以预测序列成为噬菌体的概率，分数越接近1表示噬菌体越有可能处于活跃状态。（正则化：正则化是机器学习中一种常用的技术，用于控制模型的复杂度和减少过拟合的风险，L1正则化项可以惩罚模型中大的系数，并将某些系数压缩至0，从而达到特征选择和降维的效果，因为太复杂的模型在面对新数据时的表现很差。）
（2）在这里，我们使用包含1031个活性噬菌体序列和21,979个宿主序列的数据集，使用上述24个特征进行训练。为了考虑到这个数据集高度不平衡的特点，我们对占据大多数的类别进行欠采样（不重复采样），使得训练集中主机和噬菌体的比例为50：50。 （欠采样（undersampling）是一种用于解决数据集不平衡问题的方法，它是通过减少多数类别（majority class）的样本数量来使得多数类别和少数类别（minority class）之间的样本数量比例更加平衡的方法。）
（3）为了实现该模型，我们在50个随机选择的训练集上训练50个逻辑回归模型。每个训练集包含所有噬菌体观测值和一部分1031个主机观测值。这样可以考虑到主机观测值之间的差异，同时确保数据集平衡。  （训练50个模型，防止出现出现过拟合或欠拟合的情况，随后进行模型平均，将多个模型的预测结果结合起来，得到一个更加准确的预测结果）

## 程序和网络实现
（1）Prophage Hunter Web服务器是使用经典的LAMP框架（Linux、Apache、MySQL和PHP）构建的，它是基于预测噬菌体序列的结构和功能来实现的，并结合了一系列公共生物信息学工具，例如BLAST、InterProScan、GeneMark、StringTie和Cuffcompare等。该工具还提供了交互式轻量级基因组浏览器和结果表格，方便用户更好地探索预测结果。
（2）为了进一步探索活性噬菌体的结果，还构建了一个基于Tnt Board（http://tntvis.github.io/tnt.genome/）的交互式轻量级基因组浏览器。
（3）在基因组浏览器中，可以缩放以轻松查看预测噬菌体及其活性得分（以色彩缩放显示）和预测基因（双链）。基因组浏览器和结果表格是相互关联的，以快速聚焦信息。单击基因组浏览器中的噬菌体候选项将触发详细信息的表格过滤，单击表格项目将在基因组浏览器中放大其位置。该Web服务器与大多数现代Web浏览器兼容，如Mozilla Firefox、Google Chrome、Safari和Microsoft Edge。 （可以添加使用图片的实例信息）。

## 详细工作原理及工作流程
（详细图片）

## 简单比较一下三种工具的特点
本文将Prophage Hunter与最近更新的三种工具进行了比较。MetaPhinder(16)基于与噬菌体数据库的相似性匹配，而VirFinder(13)则基于机器学习的k-mer特征来指示一个contig是否为噬菌体。在本研究中，我们将Prophage Hunter的预测得分设置为>0.8表示该区域为活性噬菌体，0.5-0.8表示不确定，<0.5表示为非活性噬菌体。

## 评估Prophage Hunter综合管道的性能
作者使用了一些人工合成的数据来验证Prophage Hunter能否准确地区分非活性噬菌体。这些人工合成的数据是通过对现有的基因组序列进行特定的突变（例如插入、删除、反转等）来生成的，以模拟一些基因组中存在的非活性噬菌体序列。通过使用这些合成的数据，作者可以测试Prophage Hunter是否能够正确地将这些序列与实际的活性噬菌体区分开来。
**结论**：
Prophage Hunter的优势：(1)在区分插入物和倒置方面的准确性高，且可以测试包含细菌全基因组组装的半合成数据集。而VirFinder和MetaPhinder只能针对较短序列构建;(2)具体数值：在参考数据集中显示出84.3％的准确性，在插入物中为24.1％，在删除中为29.7％，在倒置中为19.5％。

## 实战演示
研究人员使用丝裂霉素C诱导实验对KP6512和AB8929进行操作，并对诱导的噬菌体进行了测序。对于KP6512，Prophage Hunter 预测出4个活性噬菌体，PHASTER 预测出3个，成功诱导了一个（图3B）。对于AB8929，Prophage Hunter 预测出4个活性噬菌体，PHASTER 没有预测出，成功诱导了两个（图3C）

## 该工具的弊端
可能会出现假阳性的情况：例如，在一些情况下，一个被预测为存在的噬菌体实际上可能不存在，或者被预测为不存在的噬菌体可能存在但未被检测到。类似地，尽管用丝裂霉素C诱导噬菌体通常是成功的，但也可能出现失败的情况。如果在这种情况下噬菌体并没有诱导出来，而预测结果仍显示存在，则可能会导致假阳性的结果。

## 结论和结果
Prophages在细菌基因组中非常丰富，比裂解噬菌体更易获取。使用Prophage Hunter，我们可以利用越来越多的细菌NGS数据来挖掘噬菌体信息。预测噬菌体活性可能会发现类CRISPR系统或其他细菌对抗噬菌体的新型防御系统（19,33）。Prophage Hunter还将指导从细菌中诱导和分离温和噬菌体，从而使噬菌体生理学的研究得以深入，同时也为治疗目的开发设计噬菌体铺平了道路。

## 










































